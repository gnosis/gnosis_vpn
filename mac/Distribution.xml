<?xml version="1.0" encoding="utf-8"?>
<installer-gui-script minSpecVersion="2">
    <title>Gnosis VPN</title>
    <allowed-os-versions>
        <os-version min="14"/>
    </allowed-os-versions>
    <organization>com.gnosisvpn</organization>
    <domains enable_anywhere="true"/>

    <!-- Package metadata -->
    <pkg-ref id="com.gnosisvpn.gnosisvpnclient"/>

    <!-- Options -->
    <options customize="allow" require-scripts="false" hostArchitectures="x86_64,arm64"/>

    <!-- JavaScript for mutual exclusion -->
    <script><![CDATA[
        // LOGIC: An option is clickable (enabled) only if its counterpart is NOT selected.

        function isRotseeEnabled() {
            return !choices['dufour'].selected;
        }

        function isDufourEnabled() {
            return !choices['rotsee'].selected;
        }

        function isDebugEnabled() {
            return !choices['standard'].selected;
        }

        function isStandardEnabled() {
            return !choices['debug'].selected;
        }
    ]]></script>

    <!-- Include the icon in resources -->
    <resource mime-type="image/png" kind="file">icon_256x256.png</resource>

    <!-- Welcome screen -->
    <welcome file="welcome.html" mime-type="text/html"/>

    <!-- Read Me screen with requirements -->
    <readme file="readme.html" mime-type="text/html"/>

    <!-- Conclusion screen with next steps -->
    <conclusion file="conclusion.html" mime-type="text/html"/>

    <!-- Choices outline - what the user sees -->
    <choices-outline>
        <line choice="default"/>
        <line choice="network">
            <line choice="rotsee"/>
            <line choice="dufour"/>
        </line>
        <line choice="servicemode">
            <line choice="debug"/>
            <line choice="standard"/>
        </line>
    </choices-outline>

    <!-- Default choice -->
    <choice id="default"
            title="Gnosis VPN Client"
            description="Gnosis VPN client binaries and configuration"
            enabled="true"
            selected="true">
        <pkg-ref id="com.gnosisvpn.gnosisvpnclient"/>
    </choice>

    <!-- Network selection choice (parent group) -->
    <choice id="network"
            title="HOPR Network"
            description="Select the HOPR network configuration for your VPN destinations"
            visible="true"
            enabled="false">
    </choice>

    <!-- Rotsee network sub-choice -->
    <choice id="rotsee"
            title="Rotsee (Recommended)"
            description="Connect to VPN nodes on the Rotsee network - US, UK, Brazil, Australia, India, South Korea"
            visible="true"
            start_selected="true"
            enabled="isRotseeEnabled()">
    </choice>

    <!-- Dufour network sub-choice -->
    <choice id="dufour"
            title="Dufour"
            description="Connect to VPN nodes on the Dufour network - Germany, USA, Spain, India"
            visible="true"
            start_selected="false"
            enabled="false">
    </choice>

    <!-- Service mode selection choice (parent group) -->
    <choice id="servicemode"
            title="Service Configuration"
            description="Select the service configuration mode"
            visible="true"
            enabled="false"
            start_expanded="true">
    </choice>

    <!-- Debug mode sub-choice -->
    <choice id="debug"
            title="Debug Mode (Recommended)"
            description="Install with debug logging enabled - useful for troubleshooting"
            visible="true"
            start_selected="true"
            enabled="isDebugEnabled()">
    </choice>

    <!-- Standard mode sub-choice -->
    <choice id="standard"
            title="Standard Mode"
            description="Install with standard logging configuration"
            visible="true"
            start_selected="false"
            enabled="isStandardEnabled()">
    </choice>

    <!-- Component package reference -->
    <pkg-ref id="com.gnosisvpn.gnosisvpnclient"
             version="0"
             auth="root"
             installKBytes="16384"
             onConclusion="none">
        #GnosisVPN.pkg
    </pkg-ref>

    <!-- Localization (default English) -->
    <localization>
        <strings language="en">
            <![CDATA[
                // Installer strings
            ]]>
        </strings>
    </localization>

</installer-gui-script>