---
name: gnosisvpn
arch: "${NFPM_ARCHITECTURE}"
platform: linux
version: "${GNOSISVPN_PACKAGE_VERSION}"
section: net
priority: optional
maintainer: Hoprnet <tech@hoprnet.org>
description: |
  Decentralized, trustless, uncensorable VPN for the web3 age.
  Fully anonymous browsing over a decentralized mixnet.
license: GNU General Public License v3.0
homepage: https://gnosisvpn.com/
rpm:
  signature:
    key_file: ${GNOSISVPN_GPG_PRIVATE_KEY_PATH}
overrides:
  deb:
    depends:
      - libc6
      - systemd
      - iptables
      - logrotate
      - wireguard
      - ca-certificates
      - libwebkit2gtk-4.1-0
      - libgtk-3-0
      - libayatana-appindicator3-1
      - libglib2.0-bin
  rpm:
    depends:
      - systemd
      - iptables
      - logrotate
      - wireguard
      - ca-certificates
      - webkit2gtk4.1
      - gtk3
      - libayatana-appindicator-gtk3
      - glib2
  archlinux:
    depends:
      - webkit2gtk-4.1
      - gtk3
      - libayatana-appindicator
      - glib2
contents:
  # Binaries
  - src: ./build/download/gnosis_vpn-root
    dst: /usr/bin/gnosis_vpn-root
    file_info:
      mode: 0750
      owner: root
      group: root
  - src: ./build/download/gnosis_vpn-worker
    dst: /usr/bin/gnosis_vpn-worker
    file_info:
      mode: 0750
  - src: ./build/download/gnosis_vpn-ctl
    dst: /usr/bin/gnosis_vpn-ctl
    file_info:
      mode: 0755
  - src: ./build/gnosis_vpn-app
    dst: /usr/bin/gnosis_vpn-app
    file_info:
      mode: 0755
  # Resource files
  - src: ./linux/resources/gnosisvpn.env
    dst: /etc/gnosisvpn/gnosisvpn.env
    type: config
    file_info:
      mode: 0644
  - src: ./linux/resources/rotsee-config.toml
    dst: /etc/gnosisvpn/config.toml
    type: config
    file_info:
      mode: 0644
  - src: ./linux/resources/logrotate.conf
    dst: /etc/logrotate.d/gnosisvpn
    type: config
    file_info:
      mode: 0644
      owner: root
      group: root
  - src: ./linux/resources/gnosisvpn.service
    dst: /usr/lib/systemd/system/gnosisvpn.service
  - src: ./linux/resources/copyright
    dst: /usr/share/doc/gnosisvpn/copyright
  - src: ./build/changelog/changelog.gz
    dst: /usr/share/doc/gnosisvpn/changelog.gz
    file_info:
      mode: 0644
      owner: root
      group: root
  - src: ./linux/resources/lintian-overrides
    dst: /usr/share/lintian/overrides/gnosisvpn
    file_info:
      mode: 0644
      owner: root
      group: root
  # Manual pages
  - src: ./build/man/man1/gnosis_vpn-root.1.gz
    dst: /usr/share/man/man1/gnosis_vpn-root.1.gz
    file_info:
      mode: 0644
      owner: root
      group: root
  - src: ./build/man/man1/gnosis_vpn-worker.1.gz
    dst: /usr/share/man/man1/gnosis_vpn-worker.1.gz
    file_info:
      mode: 0644
      owner: root
      group: root
  - src: ./build/man/man1/gnosis_vpn-ctl.1.gz
    dst: /usr/share/man/man1/gnosis_vpn-ctl.1.gz
    file_info:
      mode: 0644
      owner: root
      group: root
  - src: ./build/man/man1/gnosis_vpn-app.1.gz
    dst: /usr/share/man/man1/gnosis_vpn-app.1.gz
    file_info:
      mode: 0644
      owner: root
      group: root
__GNOSIS_VPN_APP_CONTENTS__
scripts:
  preinstall: ./linux/scripts/preinstall.sh
  postinstall: ./linux/scripts/postinstall.sh
  preremove: ./linux/scripts/preuninstall.sh
  postremove: ./linux/scripts/postuninstall.sh